<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Logowanie â€” SocialApp</title>
  <!-- Favicon fix: osadzone SVG, brak 404 -->
  <link rel="icon" type="image/svg+xml" href='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><defs><linearGradient id="g" x1="0" y1="0" x2="1" y2="1"><stop offset="0" stop-color="%231877f2"/><stop offset="1" stop-color="%237aa8ff"/></linearGradient></defs><rect rx="14" width="64" height="64" fill="url(%23g)"/><path d="M34 10h-4A18 18 0 0 0 12 28v4a18 18 0 0 0 18 18h4a18 18 0 0 0 18-18v-4A18 18 0 0 0 34 10z" fill="white"/></svg>' />
  <link rel="alternate icon" href="/favicon.ico" />
  <meta name="theme-color" content="#1877f2" />
  <meta name="description" content="Nowoczesna, responsywna strona logowania z walidacjÄ…, show/hide hasÅ‚em i dostÄ™pnoÅ›ciÄ…. Zintegrowana z Flask (flash messages, csrf, POST)." />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/login.css') }}">

    <link rel="icon" type="image/svg+xml"
      href='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><defs><linearGradient id="g" x1="0" y1="0" x2="1" y2="1"><stop offset="0" stop-color="%231877f2"/><stop offset="1" stop-color="%237aa8ff"/></linearGradient></defs><rect rx="14" width="64" height="64" fill="url(%23g)"/></svg>'>
</head>
<body>
  <main class="wrap">

    <section class="card" aria-label="Panel logowania">
      <aside class="visual">
        <a class="brand" href="{{ url_for('main.index') }}">
          <span class="logo"><svg viewBox="0 0 24 24"><path d="M13.5 2h-3A8.5 8.5 0 0 0 2 10.5v3A8.5 8.5 0 0 0 10.5 22h3A8.5 8.5 0 0 0 22 13.5v-3A8.5 8.5 0 0 0 13.5 2z"/></svg></span>
          <strong>SocialApp</strong>
        </a>
        <h1>Witaj ponownie</h1>
        <p>Zaloguj siÄ™, aby kontynuowaÄ‡. TwÃ³j feed, znajomi i zapisane treÅ›ci czekajÄ….</p>
        <svg class="illus" width="360" height="360" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <circle cx="100" cy="100" r="80" stroke="white" opacity=".1"/>
          <circle cx="100" cy="100" r="60" stroke="white" opacity=".08"/>
          <circle cx="100" cy="100" r="40" stroke="white" opacity=".06"/>
        </svg>
      </aside>

      <form class="form" id="loginForm" method="POST" action="{{ url_for('auth.login') }}" novalidate>
        <h2>Zaloguj siÄ™</h2>
        <p class="muted">UÅ¼yj adresu email i hasÅ‚a do swojego konta.</p>
        <div id="formError" class="error" role="alert">NieprawidÅ‚owy email lub hasÅ‚o. SprÃ³buj ponownie.</div>
        {% if csrf_token %}<input type="hidden" name="csrf_token" value="{{ csrf_token() }}">{% endif %}

        <div class="field">
          <label for="email">Email</label>
          <div class="input">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M4 4h16a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2zm0 2l8 6 8-6"/></svg>
            <input id="email" name="email" type="email" autocomplete="email" placeholder="jan.kowalski@example.com" required />
          </div>
        </div>

        <div class="field">
          <label for="password">HasÅ‚o</label>
          <div class="input">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 17a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm6-6h-1V9a5 5 0 0 0-10 0v2H6a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7a2 2 0 0 0-2-2zm-3 0H9V9a3 3 0 0 1 6 0v2z"/></svg>
            <input id="password" name="password" type="password" autocomplete="current-password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required minlength="6" />
            <button type="button" id="togglePw" aria-label="PokaÅ¼/ukryj hasÅ‚o">ğŸ‘ï¸</button>
          </div>
        </div>

        <div class="row">
          <label class="checkbox" for="remember">
            <input id="remember" name="remember" type="checkbox" />
            <span>ZapamiÄ™taj mnie</span>
          </label>
          <a href="{{ url_for('reset.reset_password') }}#forgot" class="muted">Nie pamiÄ™tasz hasÅ‚a?</a>
        </div>

        <button class="btn primary block" type="submit">Zaloguj siÄ™</button>
    {% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div class="flash-wrap" aria-live="polite" role="status">
      {% for category, msg in messages %}
        {% set bs = {'error':'danger','danger':'danger','success':'success','info':'info','warning':'warning'}.get(category, 'info') %}
        <div class="alert alert-{{ bs }} alert-dismissible fade show mb-2" role="alert">
          {{ msg|safe }}  {# usuÅ„ |safe, jeÅ›li treÅ›Ä‡ nie jest w 100% zaufana #}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}
        <button class="btn ghost block" type="button" id="demoBtn">UÅ¼yj danych demo</button>

        <div class="social">
          <button class="btn ghost" type="button">ğŸ”µ Zaloguj z Facebook</button>
          <button class="btn ghost" type="button">âšª Zaloguj z Google</button>
        </div>

        <p class="muted" style="margin-top:8px">Nie masz konta? <a href="{{ url_for('auth.register') }}#register" style="color:var(--accent)">UtwÃ³rz konto</a></p>
      </form>
    </section>

    <footer class="page">Â© <span id="year"></span> SocialApp â€¢ Logowanie</footer>
  </main>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();
    const pw = document.getElementById('password');
    const toggle = document.getElementById('togglePw');
    toggle.addEventListener('click', () => { const t = pw.getAttribute('type') === 'password' ? 'text' : 'password'; pw.setAttribute('type', t); toggle.textContent = t === 'password' ? 'ğŸ‘ï¸' : 'ğŸ™ˆ'; });
    document.getElementById('demoBtn').addEventListener('click', () => { document.getElementById('email').value = 'demo@social.app'; document.getElementById('password').value = 'password123'; });
    const form = document.getElementById('loginForm');
    const error = document.getElementById('formError');
    form.addEventListener('submit', (e) => {
      error.classList.remove('show');
      const email = form.email.value.trim();
      const pass = form.password.value.trim();
      const ok = /.+@.+\..+/.test(email) && pass.length >= 6;
      if(!ok){ e.preventDefault(); error.classList.add('show'); }
      // JeÅ›li OK: naturalny submit do Flask (POST -> main.index) i obsÅ‚uga flash + redirect po stronie backendu.
    });
  </script>
</body>
</html>